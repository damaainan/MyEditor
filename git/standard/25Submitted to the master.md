# `发生过程`

功能分支直接提交到 master 分支

## 发生描述：
* 功能分支测试完成
* 提merge request 
* 在codereview时未发现这个问题
* 将功能分支代码合并到了master


# `危害`

## 1.危害范围

(1)日常开发

(2)上线时间

(3)分支开发的功能没有上线

## 2.危害认识

(1)影响其他同事的日常开发

*  情形一  master回滚

  * 1、负责上线的同事需要将`master回滚`到合并前的状态

  * 2、责任人`重新创建merge request`指向正确的上线分支

*  情形二  master不回滚

  * 1、责任人要从master上`新建功能分支`

  * 2、创建从新功能分支指向上线分支的merge request


(2)影响同事及自己的上线时间

*  情形一  master回滚

  * 1、负责上线的同事需要将`master回滚`到合并前的状态

  * 2、责任人重新创建merge request指向正确的上线分支

  * 3、以上会导致责任人额外工作以及延误其他项目的上线时间

*  情形二  master不回滚

  * 1、责任人要从`master上新建功能分支`

  * 2、创建从新功能分支指向上线分支的`merge request`

  * 3、以上会导致责任人额外工作以及延误其他项目的上线时间


(3)分支开发的功能没有上线

  * 1、上线的功能`没合并当天的上线分支`，合并到了master

  * 2、责任人未意识到merge request 目标分支选择错误

  * 3、责任人`本期望分支代码合并到上线分支`并上线

  * 4、上线负责人执行上线操作，`拉取上线分支代码`  

  * 5、上线负责人未察觉拉取的上线代码中`不含功能分支内容`

  * 6、上线操作完成后，分支开发的功能`没有上线`


# `解决方案`

## 操作

* 解决方式一 

  * 1、不回滚master

  * 2、从master重新拉出feature分支

  * 3、删除原功能分支

  * 4、重新提交merge request

  * 5、测试通过后，执行上线流程

  * 6、hotfix合并会master ，打tag

* 解决方式二 

  * 1、负责上线的同事需要将master的版本回滚到合并前的状态

  * 2、责任人要重新将分支指向正确的上线分支

  * 3、重新提交merge request

  * 4、测试通过后，执行上线流程

  * 5、hotfix合并会master ，打tag

## 原则

* master 是稳定分支

* 其他分支 都是不稳定分支

* 在“Merge Requests” 页面新建“merge request”,可以选择分支，避免默认的master问题

* 合并到master分支后，该功能分支生命周期既已结束

* 如需再次上线要重新创建修复分支


# `相关资料链接`

## GIT操作手册

http://dev45.gitlab.miyabaobei.com/git/demo/wikis/home#%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83 