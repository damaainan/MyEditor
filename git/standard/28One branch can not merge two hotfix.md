`发生过程`
=====
##### 一个分支合并到了两个hotfix

### 发生描述
* 创建hotfix-1紧急修复分支;
* 自己开出的分支branch-1经过修改合并到hotfix-1;
* hotfix-1回主干
* 创建hotfix-2紧急修复分支 ;
* 发现之前的代码有问题，在branch-1分支上再次修改并合并到hotfix-2;
 
`危害`
      
1.危害范围

*  (1) 紧急修复时效性

*  (2) 分支图形混乱

*  (3) 代码测试不充分导致多次上线

2、危害认识

*  (1) 紧急修复时效性
    * 紧急修复分支一般都是修复线上紧急的问题，
    * 如果有一个分支多次合并hotfix的错误出现，
     * 如果自己一个分支合并hotfix-1，
     * hotfix-1在此之后回归主干，又开出hotfix-2,
     * 如果自己旧分支中修改的代码在master中已经修改过，
     * 那将造成之前的修改被覆盖的错误，
    * 在此之后又有其他工程师合并hotfix-2，
    * 发布工程师为了解决合并流程错误(功能分支错误的二次合并导致hotfix分支可能存在代码被覆盖的风险)，要重新开出新的hotfix-3，或者要把hotfix-2回滚到错误分支合并之前的版本，
    * 需要通知受影响工程师重新合并hotfix，
    * 结果影响到其他工程师功能及时上线（因为之前一次合并作废了），
    * 增加上线工程师的工作量，需要根据影响的范围对hotfix做修复操作。

* (2) 增加了分支图形的复杂程度
    * 因为一个新的分支合并后不能再次合并，这样同一个分支多次合并上线，会造成分支图形混乱，其他人理解起来更费时费力。

* (3) 代码测试不充分导致多次上线
    * 代码测试不充分导致bug不断出现，
    * 代码上线前首先要工程师自测，保证基本问题都解决，
    * 工程师开发的功能要保证有单元测试覆盖，每次都进行自动测试。

`解决方案`
=====
*  1、如果问题代码已经在旧分支上修复，还需要使用旧分支代码，那么处理方法是：
     * 把现在的分支通过git比较工具找出修改的代码，
     * 从master上开出一个新的分支，
     * 把修改的代码复制到新的分支上，
     * 经过充分的测试，保证没有问题的情况下重新合并到发布分支，走发布流程上线。

*  2、如果不需要使用旧分支代码，那么处理方法是：
     * 从master上开出一个新的分支，在新的分支上修改代码，
     * 经过充分的测试，保证没有问题的情况下重新合并到发布分支，走发布流程上线。

`注意`
=====
 * (1)    一个分支合并到发布分支后，如果发布分支没有回master，可以再次使用此分支，
 * (2)    如果这个发布分支已经回master，则这个分支一定要删除，包括本地分支和远程分支。
 * (3)     同一个分支多次合并hotfix一般都是同一个功能不断的出现问题，
 * (4)    为了避免这种情况，要在每次合并代码前都做好充分的测试，包括手动的测试和自动的单元测试，
 * (5)    只有对自己写的代码负责，才能最大限度的保证不出问题。

`参考资料`
=====
[为什么一个分支不能提交两次](why-branch-only-allow-merge-one-times)